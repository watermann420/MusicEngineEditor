<UserControl x:Class="MusicEngineEditor.Controls.Effects.SpectralGateControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:MusicEngineEditor.Controls.Effects"
             mc:Ignorable="d"
             d:DesignHeight="500" d:DesignWidth="600"
             Background="#0D0D0D">

    <UserControl.Resources>
        <!-- Theme Colors -->
        <Color x:Key="SpectralGateBackgroundColor">#0D0D0D</Color>
        <Color x:Key="SpectralGatePanelColor">#181818</Color>
        <Color x:Key="SpectralGateAccentColor">#00D9FF</Color>
        <Color x:Key="SpectralGateSuccessColor">#00FF88</Color>
        <Color x:Key="SpectralGateErrorColor">#FF4757</Color>
        <Color x:Key="SpectralGateTextColor">#E0E0E0</Color>
        <Color x:Key="SpectralGateSecondaryTextColor">#808080</Color>
        <Color x:Key="SpectralGateBorderColor">#2A2A2A</Color>
        <Color x:Key="SpectralGateGatedColor">#FF4757</Color>
        <Color x:Key="SpectralGateOpenColor">#00FF88</Color>

        <!-- Brushes -->
        <SolidColorBrush x:Key="SpectralGateBackgroundBrush" Color="{StaticResource SpectralGateBackgroundColor}"/>
        <SolidColorBrush x:Key="SpectralGatePanelBrush" Color="{StaticResource SpectralGatePanelColor}"/>
        <SolidColorBrush x:Key="SpectralGateAccentBrush" Color="{StaticResource SpectralGateAccentColor}"/>
        <SolidColorBrush x:Key="SpectralGateSuccessBrush" Color="{StaticResource SpectralGateSuccessColor}"/>
        <SolidColorBrush x:Key="SpectralGateErrorBrush" Color="{StaticResource SpectralGateErrorColor}"/>
        <SolidColorBrush x:Key="SpectralGateTextBrush" Color="{StaticResource SpectralGateTextColor}"/>
        <SolidColorBrush x:Key="SpectralGateSecondaryTextBrush" Color="{StaticResource SpectralGateSecondaryTextColor}"/>
        <SolidColorBrush x:Key="SpectralGateBorderBrush" Color="{StaticResource SpectralGateBorderColor}"/>
        <SolidColorBrush x:Key="SpectralGateGatedBrush" Color="{StaticResource SpectralGateGatedColor}"/>
        <SolidColorBrush x:Key="SpectralGateOpenBrush" Color="{StaticResource SpectralGateOpenColor}"/>

        <!-- Gradient for spectrum bars -->
        <LinearGradientBrush x:Key="SpectralGateSpectrumGradient" StartPoint="0,1" EndPoint="0,0">
            <GradientStop Color="#004D66" Offset="0.0"/>
            <GradientStop Color="#006680" Offset="0.3"/>
            <GradientStop Color="#00A8CC" Offset="0.6"/>
            <GradientStop Color="#00D9FF" Offset="0.85"/>
            <GradientStop Color="#7FECFF" Offset="1.0"/>
        </LinearGradientBrush>

        <!-- Parameter Slider Style -->
        <Style x:Key="SpectralGateSliderStyle" TargetType="Slider">
            <Setter Property="Minimum" Value="0"/>
            <Setter Property="Maximum" Value="100"/>
            <Setter Property="Height" Value="20"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Slider">
                        <Grid>
                            <Border Height="4" VerticalAlignment="Center"
                                    Background="#2A2A2A" CornerRadius="2"/>
                            <Border x:Name="PART_SelectionRange" Height="4" VerticalAlignment="Center"
                                    Background="{StaticResource SpectralGateAccentBrush}" CornerRadius="2"
                                    HorizontalAlignment="Left"
                                    Width="{Binding ActualWidth, RelativeSource={RelativeSource TemplatedParent},
                                            Converter={x:Static local:SpectralGatePercentageConverter.Instance},
                                            ConverterParameter={Binding Value, RelativeSource={RelativeSource TemplatedParent}}}"/>
                            <Track x:Name="PART_Track">
                                <Track.Thumb>
                                    <Thumb Width="14" Height="14">
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Ellipse Fill="{StaticResource SpectralGateAccentBrush}"
                                                         Width="14" Height="14"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Parameter Label Style -->
        <Style x:Key="SpectralGateParameterLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="{StaticResource SpectralGateSecondaryTextBrush}"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>

        <!-- Parameter Value Style -->
        <Style x:Key="SpectralGateParameterValueStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="{StaticResource SpectralGateTextBrush}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="MinWidth" Value="50"/>
            <Setter Property="TextAlignment" Value="Right"/>
        </Style>

        <!-- Button Style -->
        <Style x:Key="SpectralGateButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource SpectralGatePanelBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource SpectralGateTextBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource SpectralGateBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="BorderBrush"
                                        Value="{StaticResource SpectralGateAccentBrush}"/>
                                <Setter TargetName="border" Property="Background" Value="#222222"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background"
                                        Value="{StaticResource SpectralGateAccentBrush}"/>
                                <Setter Property="Foreground" Value="#0D0D0D"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Primary Button Style -->
        <Style x:Key="SpectralGatePrimaryButtonStyle" TargetType="Button" BasedOn="{StaticResource SpectralGateButtonStyle}">
            <Setter Property="Background" Value="{StaticResource SpectralGateAccentBrush}"/>
            <Setter Property="Foreground" Value="#0D0D0D"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <!-- Toggle Button Style -->
        <Style x:Key="SpectralGateToggleButtonStyle" TargetType="ToggleButton">
            <Setter Property="Background" Value="{StaticResource SpectralGatePanelBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource SpectralGateTextBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource SpectralGateBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background"
                                        Value="{StaticResource SpectralGateAccentBrush}"/>
                                <Setter Property="Foreground" Value="#0D0D0D"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="BorderBrush"
                                        Value="{StaticResource SpectralGateAccentBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Border BorderBrush="{StaticResource SpectralGateBorderBrush}"
            BorderThickness="1"
            CornerRadius="6"
            Background="{StaticResource SpectralGateBackgroundBrush}"
            Padding="16">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*" MinHeight="200"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Grid Grid.Row="0" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           Text="Spectral Gate"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Foreground="{StaticResource SpectralGateTextBrush}"
                           VerticalAlignment="Center"/>

                <!-- Threshold Mode Selection -->
                <ComboBox Grid.Column="1"
                          x:Name="ThresholdModeComboBox"
                          Margin="0,0,12,0"
                          MinWidth="130"
                          SelectionChanged="ThresholdModeComboBox_SelectionChanged"
                          ToolTip="Threshold mode">
                    <ComboBoxItem Content="Global" IsSelected="True"/>
                    <ComboBoxItem Content="Frequency Curve"/>
                    <ComboBoxItem Content="Adaptive"/>
                </ComboBox>

                <ToggleButton Grid.Column="2"
                              x:Name="BypassToggle"
                              Content="Bypass"
                              Style="{StaticResource SpectralGateToggleButtonStyle}"
                              Click="BypassToggle_Click"/>
            </Grid>

            <!-- Spectrum Display with Drawable Threshold -->
            <Border Grid.Row="1"
                    Background="{StaticResource SpectralGatePanelBrush}"
                    BorderBrush="{StaticResource SpectralGateBorderBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Margin="0,0,0,12">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="40"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- dB Scale -->
                    <Canvas x:Name="DbScaleCanvas"
                            Grid.Row="0" Grid.Column="0"
                            Background="Transparent"/>

                    <!-- Main Spectrum Canvas -->
                    <Canvas x:Name="SpectrumCanvas"
                            Grid.Row="0" Grid.Column="1"
                            ClipToBounds="True"
                            Background="Transparent"
                            MouseLeftButtonDown="SpectrumCanvas_MouseLeftButtonDown"
                            MouseLeftButtonUp="SpectrumCanvas_MouseLeftButtonUp"
                            MouseMove="SpectrumCanvas_MouseMove"
                            MouseLeave="SpectrumCanvas_MouseLeave"/>

                    <!-- Frequency Labels -->
                    <Canvas x:Name="FrequencyLabelCanvas"
                            Grid.Row="1" Grid.Column="1"
                            Height="20"
                            Background="Transparent"/>

                    <!-- Draw Mode Indicator -->
                    <Border Grid.Row="0" Grid.Column="1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Background="#80000000"
                            CornerRadius="0,0,0,4"
                            Padding="8,4">
                        <TextBlock x:Name="DrawModeIndicator"
                                   Text="Click and drag to draw threshold curve"
                                   FontSize="10"
                                   Foreground="{StaticResource SpectralGateSecondaryTextBrush}"/>
                    </Border>
                </Grid>
            </Border>

            <!-- Gate Activity Display -->
            <Border Grid.Row="2"
                    Background="{StaticResource SpectralGatePanelBrush}"
                    BorderBrush="{StaticResource SpectralGateBorderBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Height="30"
                    Margin="0,0,0,12">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                               Text="Gate Activity:"
                               FontSize="11"
                               Foreground="{StaticResource SpectralGateSecondaryTextBrush}"
                               VerticalAlignment="Center"
                               Margin="8,0"/>

                    <Canvas x:Name="GateActivityCanvas"
                            Grid.Column="1"
                            ClipToBounds="True"
                            Margin="0,4"/>
                </Grid>
            </Border>

            <!-- Parameter Controls -->
            <Grid Grid.Row="3" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="12"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="12"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="12"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Threshold -->
                <StackPanel Grid.Row="0" Grid.Column="0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Threshold"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="ThresholdValue" Text="-40 dB"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="ThresholdSlider"
                            Minimum="-80" Maximum="0" Value="-40"
                            ValueChanged="ThresholdSlider_ValueChanged"
                            ToolTip="Global threshold level in dB"/>
                </StackPanel>

                <!-- Attack -->
                <StackPanel Grid.Row="0" Grid.Column="2">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Attack"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="AttackValue" Text="5 ms"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="AttackSlider"
                            Minimum="0.1" Maximum="1000" Value="5"
                            ValueChanged="AttackSlider_ValueChanged"
                            ToolTip="Gate attack time in milliseconds"/>
                </StackPanel>

                <!-- Release -->
                <StackPanel Grid.Row="0" Grid.Column="4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Release"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="ReleaseValue" Text="50 ms"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="ReleaseSlider"
                            Minimum="1" Maximum="5000" Value="50"
                            ValueChanged="ReleaseSlider_ValueChanged"
                            ToolTip="Gate release time in milliseconds"/>
                </StackPanel>

                <!-- Hold -->
                <StackPanel Grid.Row="0" Grid.Column="6">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Hold"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="HoldValue" Text="20 ms"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="HoldSlider"
                            Minimum="0" Maximum="2000" Value="20"
                            ValueChanged="HoldSlider_ValueChanged"
                            ToolTip="Hold time before gate closes"/>
                </StackPanel>

                <!-- Range -->
                <StackPanel Grid.Row="2" Grid.Column="0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Range"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="RangeValue" Text="-60 dB"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="RangeSlider"
                            Minimum="-80" Maximum="0" Value="-60"
                            ValueChanged="RangeSlider_ValueChanged"
                            ToolTip="Maximum attenuation when gate is closed"/>
                </StackPanel>

                <!-- Frequency Low -->
                <StackPanel Grid.Row="2" Grid.Column="2">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Freq Low"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="FreqLowValue" Text="20 Hz"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="FreqLowSlider"
                            Minimum="20" Maximum="20000" Value="20"
                            ValueChanged="FreqLowSlider_ValueChanged"
                            ToolTip="Low frequency limit for gating"/>
                </StackPanel>

                <!-- Frequency High -->
                <StackPanel Grid.Row="2" Grid.Column="4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Freq High"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="FreqHighValue" Text="20 kHz"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="FreqHighSlider"
                            Minimum="20" Maximum="20000" Value="20000"
                            ValueChanged="FreqHighSlider_ValueChanged"
                            ToolTip="High frequency limit for gating"/>
                </StackPanel>

                <!-- Curve Slope (for Frequency Curve mode) -->
                <StackPanel Grid.Row="2" Grid.Column="6" x:Name="CurveSlopePanel">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Curve Slope"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="CurveSlopeValue" Text="6 dB/oct"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="CurveSlopeSlider"
                            Minimum="-24" Maximum="24" Value="6"
                            ValueChanged="CurveSlopeSlider_ValueChanged"
                            ToolTip="Threshold curve slope in dB per octave"/>
                </StackPanel>

                <!-- Lookahead -->
                <StackPanel Grid.Row="4" Grid.Column="0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Lookahead"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="LookaheadValue" Text="0 ms"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="LookaheadSlider"
                            Minimum="0" Maximum="50" Value="0"
                            ValueChanged="LookaheadSlider_ValueChanged"
                            ToolTip="Lookahead time for smoother gating (adds latency)"/>
                </StackPanel>

                <!-- Adaptive Ratio (for Adaptive mode) -->
                <StackPanel Grid.Row="4" Grid.Column="2" x:Name="AdaptiveRatioPanel" Visibility="Collapsed">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Adaptive Ratio"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="AdaptiveRatioValue" Text="70%"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="AdaptiveRatioSlider"
                            Minimum="0" Maximum="100" Value="70"
                            ValueChanged="AdaptiveRatioSlider_ValueChanged"
                            ToolTip="Ratio below average spectrum for adaptive threshold"/>
                </StackPanel>

                <!-- Mix -->
                <StackPanel Grid.Row="4" Grid.Column="4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Mix"
                                   Style="{StaticResource SpectralGateParameterLabelStyle}"/>
                        <TextBlock Grid.Column="1" x:Name="MixValue" Text="100%"
                                   Style="{StaticResource SpectralGateParameterValueStyle}"/>
                    </Grid>
                    <Slider x:Name="MixSlider"
                            Minimum="0" Maximum="100" Value="100"
                            ValueChanged="MixSlider_ValueChanged"
                            ToolTip="Dry/Wet mix"/>
                </StackPanel>
            </Grid>

            <!-- Bottom Buttons -->
            <Grid Grid.Row="4">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Learn Noise Profile Button -->
                <Button Grid.Column="0"
                        x:Name="LearnButton"
                        Content="Learn Noise"
                        Style="{StaticResource SpectralGatePrimaryButtonStyle}"
                        Click="LearnButton_Click"
                        ToolTip="Capture noise profile from current input"
                        Margin="0,0,8,0"/>

                <!-- Clear Threshold Button -->
                <Button Grid.Column="1"
                        x:Name="ClearThresholdButton"
                        Content="Reset Curve"
                        Style="{StaticResource SpectralGateButtonStyle}"
                        Click="ClearThresholdButton_Click"
                        ToolTip="Reset threshold curve to default"/>

                <!-- Presets -->
                <ComboBox Grid.Column="3"
                          x:Name="PresetComboBox"
                          MinWidth="150"
                          Margin="0,0,8,0"
                          SelectionChanged="PresetComboBox_SelectionChanged"
                          ToolTip="Load preset">
                    <ComboBoxItem Content="-- Presets --" IsSelected="True"/>
                    <ComboBoxItem Content="Noise Reduction"/>
                    <ComboBoxItem Content="Low Pass Gate"/>
                    <ComboBoxItem Content="Creative"/>
                    <ComboBoxItem Content="Aggressive"/>
                </ComboBox>

                <!-- Status -->
                <Border Grid.Column="4"
                        Background="{StaticResource SpectralGatePanelBrush}"
                        BorderBrush="{StaticResource SpectralGateBorderBrush}"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="12,6"
                        MinWidth="120">
                    <TextBlock x:Name="StatusText"
                               Text="Ready"
                               FontSize="11"
                               Foreground="{StaticResource SpectralGateSecondaryTextBrush}"
                               HorizontalAlignment="Center"/>
                </Border>
            </Grid>
        </Grid>
    </Border>
</UserControl>
